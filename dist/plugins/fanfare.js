"use strict";var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}/** Fanfare Plugin
 *
 * Demonstrates an example "Fanfare" plugin that displays a FrankerZ whenever
 * someone subscribes.
 *
 * Commands:
 *  //ff on:        Enables fanfare
 *  //ff off:       Disables fanfare
 *  //ff show-sub:  Demonstrates the subscription fanfare
 *  //ff:           Displays //ff usage and whether or not fanfare is enabled
 *//* vim: set ts=2 sts=2 sw=2 et: */var FanfareCSS="\nimg.ff.ff-sub {\n  position: absolute;\n  display: none;\n}\n.ff.ff-particle {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  z-index: 100;\n}\n",FanfarePlugin=function(){/* exported FanfarePlugin */function a(b,c,d,e,f){if(_classCallCheck(this,a),this._args=e,this._on=!1,this._particles=[],this._nparticles=e.nparticles||10,f.PluginConfig&&f.PluginConfig.Fanfare){var g=f.PluginConfig.Fanfare;g.N&&(this._nparticles=g.N),g.On&&(this._on=!0)}this._setupCSS(),this._setupParticles();ChatCommands.add("ff",this._onCmd,"From plugin FanfarePlugin: Enable or disable fanfare",this),ChatCommands.addUsage("ff","on","From plugin FanfarePlugin: Enable fanfare"),ChatCommands.addUsage("ff","off","From plugin FanfarePlugin: Disable fanfare"),ChatCommands.addUsage("ff","show-sub","From plugin FanfarePlugin: Display the subscriber fanfare"),ChatCommands.addUsage("ff","particles <N>","From plugin FanfarePlugin: Set the number of particles to <N>"),d.bind("twitch-sub",this._onSubEvent.bind(this,d)),d.bind("twitch-resub",this._onSubEvent.bind(this,d)),d.bind("twitch-giftsub",this._onSubEvent.bind(this,d)),d.bind("twitch-anongiftsub",this._onSubEvent.bind(this,d)),b(this)}return _createClass(a,[{key:"_setupCSS",value:function b(){var a=document.createElement("style");a.setAttribute("type","text/css"),a.setAttribute("id","ff-styles"),a.setAttribute("data-from","plugin"),a.innerText=FanfareCSS,document.head.appendChild(a)}},{key:"_setupParticles",value:function g(){var a=!0,b=!1,c=void 0;try{for(var d,e,f=this._particles[Symbol.iterator]();!(a=(d=f.next()).done);a=!0)e=d.value,$(e).remove()}catch(a){b=!0,c=a}finally{try{!a&&f.return&&f.return()}finally{if(b)throw c}}this._particles=[];for(var h,j=0;j<this._nparticles;++j)h=$("<span class=\"ff ff-particle\"></span>"),h.attr("data-source","FanfarePlugin"),h.attr("data-ff-particle",j),h.attr("id","ff-particle-"+j),h.hide(),$("body").append(h)}},{key:"_onCmd",value:function e(a,b,c,d){if(0===b.length)d._on?Content.addInfo("Fanfare is enabled"):Content.addInfo("Fanfare is disabled"),this.printUsage();else if("on"===b[0]||"off"===b[0])d._on="on"===b[0],Content.addInfo("Fanfare is now "+(d._on?"enabled":"disabled"));else if("show-sub"===b[0]){var f=d._on;d._on=!0,d._onSubEvent(c,{}),d._on=f}else Content.addError("Fanfare: unknown argument "+b[0].escape()),this.printUsage()}},{key:"_onSubEvent",value:function k(a){var b=this;if(this._on){var d=function(d){var c=$(d),e=$("<img class=\"ff ff-sub\" width=\"100%\" height=\"100%\" />");e.attr("src",a.GetEmote("FrankerZ")),e.css("position","absolute");var f=b;e.on("load",function(){$(this).fadeTo(400,.25),window.setTimeout(f._removeFanfare.bind(f,this),1e3)}),c.prepend(e)},e=!0,f=!1,g=void 0;try{for(var h,d,j=$(".module .content")[Symbol.iterator]();!(e=(h=j.next()).done);e=!0)i=h.value,d(d)}catch(a){f=!0,g=a}finally{try{!e&&j.return&&j.return()}finally{if(f)throw g}}}}},{key:"_removeFanfare",value:function b(a){$(a).fadeOut(400,function(){$(this).hide()})}},{key:"toString",value:function a(){return"[object FanfarePlugin]"}},{key:"name",get:function a(){return"FanfarePlugin"}}]),a}();