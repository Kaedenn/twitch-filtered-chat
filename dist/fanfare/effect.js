/* Twitch Filtered Chat Fanfare: Effects */"use strict";var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}/* globals FanfareParticle */var FanfareEffect=function(){/* exported FanfareEffect */function a(b,c){_classCallCheck(this,a),this._plugin=b,this._config=c,this._particles=[],this._cb={}}return _createClass(a,[{key:"fire",value:function f(a){if(this._cb.hasOwnProperty(a)){for(var b,c=arguments.length,d=Array(1<c?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(b=this._cb)[a].apply(b,d)}}},{key:"load",value:function a(){return new Promise(function(a,b){var c=this._plugin.twitchEmote(this.emote);c.onload=function(b){this._image=c,this.fire("load",this),this.initialize(),a(b)}.bind(this),c.onerror=function(a){b(a)}.bind(this)}.bind(this))}},{key:"start",value:function a(){this.initialize(),this.fire("start",this)}},{key:"tick",value:function h(){this.fire("tick",this);var a=0,b=!0,c=!1,d=void 0;try{for(var e,f,g=this._particles[Symbol.iterator]();!(b=(e=g.next()).done);b=!0)f=e.value,f.tick(),f.alive&&(a+=1)}catch(a){c=!0,d=a}finally{try{!b&&g.return&&g.return()}finally{if(c)throw d}}return 0==a&&(this.fire("end",this),this.fire("complete",this)),0<a}},{key:"draw",value:function h(a){this.fire("predraw",this);var b=!0,c=!1,d=void 0;try{for(var e,f,g=this._particles[Symbol.iterator]();!(b=(e=g.next()).done);b=!0)f=e.value,f.draw(a)}catch(a){c=!0,d=a}finally{try{!b&&g.return&&g.return()}finally{if(c)throw d}}this.fire("draw",this)}},{key:"count",get:function a(){return this._particles.length}},{key:"alive",get:function a(){return this._particles.filter(function(a){return a.alive}).length}},{key:"onload",get:function a(){return this._cb.onload},set:function b(a){this._cb.onload=a}},{key:"onpredraw",get:function a(){return this._cb.onpredraw},set:function b(a){this._cb.onpredraw=a}},{key:"ondraw",get:function a(){return this._cb.ondraw},set:function b(a){this._cb.ondraw=a}},{key:"onstart",get:function a(){return this._cb.start},set:function b(a){this._cb.start=a}},{key:"onend",get:function a(){return this._cb.end},set:function b(a){this._cb.end=a}},{key:"oncomplete",get:function a(){return this._cb.complete},set:function b(a){this._cb.complete=a}}]),a}(),FanfareCheerEffect=function(a){/* exported FanfareCheerEffect */function b(a,c,d){_classCallCheck(this,b);var e=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return e._event=d,e}return _inherits(b,a),_createClass(b,[{key:"initialize",/* Called by base class */value:function a(){for(var b=0;b<this.num;++b)this._particles.push(new FanfareParticle({xmin:0,xmax:this._plugin.width-40,ymin:this._plugin.height-100,ymax:this._plugin.height-30,dxmin:0,dxmax:1,dymin:0,dymax:1,xforcemin:-.1,xforcemax:.1,yforcemin:-.5,yforcemax:0,image:this._image}))}},{key:"num",get:function a(){return this._config.numparticles?this._config.numparticles:this._image&&this._image.width?this._plugin.width/this._image.width:10}},{key:"emote",get:function a(){return this._config.cheeremote?this._config.cheeremote:this._config.emote?this._config.emote:"FrankerZ"}}]),b}(FanfareEffect),FanfareSubEffect=function(a){/* exported FanfareSubEffect */function b(a,c,d){_classCallCheck(this,b);var e=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return e._event=d,e}return _inherits(b,a),_createClass(b,[{key:"initialize",/* Called by base class */value:function a(){for(var b=0;b<this.num;++b)this._particles.push(new FanfareParticle({xmin:0,xmax:this._plugin.width-40,ymin:this._plugin.height-100,ymax:this._plugin.height-30,dxrange:[-5,5],dyrange:[-4,1],xforcemin:-.1,xforcemax:.1,yforcemin:-.5,yforcemax:0,image:this._image}))}},{key:"num",get:function a(){return this._config.numparticles?this._config.numparticles:this._image&&this._image.width?this._plugin.width/this._image.width:10}},{key:"emote",get:function a(){return this._config.subemote?this._config.subemote:this._config.emote?this._config.emote:"HolidayPresent"}}]),b}(FanfareEffect);