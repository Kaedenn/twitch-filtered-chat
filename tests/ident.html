<!DOCTYPE xhtml>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>OBS Identification for DwangoAC</title>
  <meta charset="utf-8" />
  <script type="text/javascript" src="https://kaedenn.github.io/twitch-filtered-chat/assets/jquery-3.3.1.min.js"></script>
  <style type="text/css">
body {
  background-color: white;
  color: black;
}
#injector {
  width: 80%;
  min-height: 256px;
  max-height: 100%;
}
.content, .injOutput {
  counter-reset: line;
}
.line {
  display: block;
  line-height: 1em;
}
.line:before {
  counter-increment: line;
  content: counter(line);
  display: inline-block;
  border-right: 1px solid gray;
  padding: 0 0.5em;
  margin-right: 0.5em;
  font-family: monospace;
  min-width: 16px;
  text-align: right;
}
.im {
  font-weight: bold;
}

pre {
  display: inline;
  margin-top: 0px;
  margin-bottom: 0px;
  padding-top: 0px;
  padding-bottom: 0px;
}
  </style>
  <script type="text/javascript">
window.DFLT_WINDOW_ATTRIBS = [
  "AbortController", "AbortSignal", "AnalyserNode", "Animation",
  "AnimationEffect", "AnimationEvent", "AnimationPlaybackEvent", "Array",
  "ArrayBuffer", "Attr", "Audio", "AudioBuffer", "AudioBufferSourceNode",
  "AudioContext", "AudioDestinationNode", "AudioListener", "AudioNode",
  "AudioParam", "AudioProcessingEvent", "AudioScheduledSourceNode",
  "AuthenticatorAssertionResponse", "AuthenticatorAttestationResponse",
  "AuthenticatorResponse", "BarProp", "BaseAudioContext", "BatteryManager",
  "BeforeUnloadEvent", "BiquadFilterNode", "Blob", "BlobEvent", "Boolean",
  "BroadcastChannel", "ByteLengthQueuingStrategy", "CDATASection", "CSS",
  "CSS2Properties", "CSSConditionRule", "CSSCounterStyleRule",
  "CSSFontFaceRule", "CSSFontFeatureValuesRule", "CSSGroupingRule",
  "CSSImportRule", "CSSKeyframeRule", "CSSKeyframesRule", "CSSMediaRule",
  "CSSMozDocumentRule", "CSSNamespaceRule", "CSSPageRule", "CSSRule",
  "CSSRuleList", "CSSStyleDeclaration", "CSSStyleRule", "CSSStyleSheet",
  "CSSSupportsRule", "Cache", "CacheStorage", "CanvasCaptureMediaStream",
  "CanvasGradient", "CanvasPattern", "CanvasRenderingContext2D",
  "CaretPosition", "ChannelMergerNode", "ChannelSplitterNode", "CharacterData",
  "Clipboard", "ClipboardEvent", "CloseEvent", "Comment", "CompositionEvent",
  "ConstantSourceNode", "ConvolverNode", "CountQueuingStrategy", "Credential",
  "CredentialsContainer", "Crypto", "CryptoKey", "CustomElementRegistry",
  "CustomEvent", "DOMError", "DOMException", "DOMImplementation", "DOMMatrix",
  "DOMMatrixReadOnly", "DOMParser", "DOMPoint", "DOMPointReadOnly", "DOMQuad",
  "DOMRect", "DOMRectList", "DOMRectReadOnly", "DOMRequest", "DOMStringList",
  "DOMStringMap", "DOMTokenList", "DataTransfer", "DataTransferItem",
  "DataTransferItemList", "DataView", "Date", "DelayNode", "DeviceMotionEvent",
  "DeviceOrientationEvent", "Directory", "Document", "DocumentFragment",
  "DocumentType", "DragEvent", "DynamicsCompressorNode", "Element", "Error",
  "ErrorEvent", "EvalError", "Event", "EventSource", "EventTarget", "File",
  "FileList", "FileReader", "FileSystem", "FileSystemDirectoryEntry",
  "FileSystemDirectoryReader", "FileSystemEntry", "FileSystemFileEntry",
  "Float32Array", "Float64Array", "FocusEvent", "FontFace", "FontFaceSet",
  "FontFaceSetLoadEvent", "FormData", "Function", "GainNode", "Gamepad",
  "GamepadButton", "GamepadEvent", "GamepadHapticActuator", "GamepadPose",
  "HTMLAllCollection", "HTMLAnchorElement", "HTMLAreaElement",
  "HTMLAudioElement", "HTMLBRElement", "HTMLBaseElement", "HTMLBodyElement",
  "HTMLButtonElement", "HTMLCanvasElement", "HTMLCollection",
  "HTMLDListElement", "HTMLDataElement", "HTMLDataListElement",
  "HTMLDetailsElement", "HTMLDirectoryElement", "HTMLDivElement",
  "HTMLDocument", "HTMLElement", "HTMLEmbedElement", "HTMLFieldSetElement",
  "HTMLFontElement", "HTMLFormControlsCollection", "HTMLFormElement",
  "HTMLFrameElement", "HTMLFrameSetElement", "HTMLHRElement", "HTMLHeadElement",
  "HTMLHeadingElement", "HTMLHtmlElement", "HTMLIFrameElement",
  "HTMLImageElement", "HTMLInputElement", "HTMLLIElement", "HTMLLabelElement",
  "HTMLLegendElement", "HTMLLinkElement", "HTMLMapElement",
  "HTMLMarqueeElement", "HTMLMediaElement", "HTMLMenuElement",
  "HTMLMenuItemElement", "HTMLMetaElement", "HTMLMeterElement",
  "HTMLModElement", "HTMLOListElement", "HTMLObjectElement",
  "HTMLOptGroupElement", "HTMLOptionElement", "HTMLOptionsCollection",
  "HTMLOutputElement", "HTMLParagraphElement", "HTMLParamElement",
  "HTMLPictureElement", "HTMLPreElement", "HTMLProgressElement",
  "HTMLQuoteElement", "HTMLScriptElement", "HTMLSelectElement",
  "HTMLSlotElement", "HTMLSourceElement", "HTMLSpanElement", "HTMLStyleElement",
  "HTMLTableCaptionElement", "HTMLTableCellElement", "HTMLTableColElement",
  "HTMLTableElement", "HTMLTableRowElement", "HTMLTableSectionElement",
  "HTMLTemplateElement", "HTMLTextAreaElement", "HTMLTimeElement",
  "HTMLTitleElement", "HTMLTrackElement", "HTMLUListElement",
  "HTMLUnknownElement", "HTMLVideoElement", "HashChangeEvent", "Headers",
  "History", "IDBCursor", "IDBCursorWithValue", "IDBDatabase", "IDBFactory",
  "IDBFileHandle", "IDBFileRequest", "IDBIndex", "IDBKeyRange",
  "IDBMutableFile", "IDBObjectStore", "IDBOpenDBRequest", "IDBRequest",
  "IDBTransaction", "IDBVersionChangeEvent", "IIRFilterNode", "IdleDeadline",
  "Image", "ImageBitmap", "ImageBitmapRenderingContext", "ImageData",
  "Infinity", "InputEvent", "InstallTrigger", "Int16Array", "Int32Array",
  "Int8Array", "InternalError", "IntersectionObserver",
  "IntersectionObserverEntry", "Intl", "JSON", "KeyEvent", "KeyboardEvent",
  "KeyframeEffect", "Location", "Map", "Math", "MediaCapabilities",
  "MediaCapabilitiesInfo", "MediaDeviceInfo", "MediaDevices",
  "MediaElementAudioSourceNode", "MediaEncryptedEvent", "MediaError",
  "MediaKeyError", "MediaKeyMessageEvent", "MediaKeySession",
  "MediaKeyStatusMap", "MediaKeySystemAccess", "MediaKeys", "MediaList",
  "MediaQueryList", "MediaQueryListEvent", "MediaRecorder",
  "MediaRecorderErrorEvent", "MediaSource", "MediaStream",
  "MediaStreamAudioDestinationNode", "MediaStreamAudioSourceNode",
  "MediaStreamEvent", "MediaStreamTrack", "MediaStreamTrackEvent",
  "MessageChannel", "MessageEvent", "MessagePort", "MimeType", "MimeTypeArray",
  "MouseEvent", "MouseScrollEvent", "MutationEvent", "MutationObserver",
  "MutationRecord", "NaN", "NamedNodeMap", "Navigator", "Node", "NodeFilter",
  "NodeIterator", "NodeList", "Notification", "NotifyPaintEvent", "Number",
  "Object", "OfflineAudioCompletionEvent", "OfflineAudioContext",
  "OfflineResourceList", "Option", "OscillatorNode", "PageTransitionEvent",
  "PaintRequest", "PaintRequestList", "PannerNode", "Path2D", "Performance",
  "PerformanceEntry", "PerformanceMark", "PerformanceMeasure",
  "PerformanceNavigation", "PerformanceNavigationTiming", "PerformanceObserver",
  "PerformanceObserverEntryList", "PerformanceResourceTiming",
  "PerformanceServerTiming", "PerformanceTiming", "PeriodicWave",
  "PermissionStatus", "Permissions", "Plugin", "PluginArray", "PointerEvent",
  "PopStateEvent", "PopupBlockedEvent", "ProcessingInstruction",
  "ProgressEvent", "Promise", "Proxy", "PublicKeyCredential", "PushManager",
  "PushSubscription", "PushSubscriptionOptions", "RTCCertificate",
  "RTCDTMFSender", "RTCDTMFToneChangeEvent", "RTCDataChannel",
  "RTCDataChannelEvent", "RTCIceCandidate", "RTCPeerConnection",
  "RTCPeerConnectionIceEvent", "RTCRtpReceiver", "RTCRtpSender",
  "RTCRtpTransceiver", "RTCSessionDescription", "RTCStatsReport",
  "RTCTrackEvent", "RadioNodeList", "Range", "RangeError", "ReadableStream",
  "ReferenceError", "Reflect", "RegExp", "Request", "Response", "SVGAElement",
  "SVGAngle", "SVGAnimateElement", "SVGAnimateMotionElement",
  "SVGAnimateTransformElement", "SVGAnimatedAngle", "SVGAnimatedBoolean",
  "SVGAnimatedEnumeration", "SVGAnimatedInteger", "SVGAnimatedLength",
  "SVGAnimatedLengthList", "SVGAnimatedNumber", "SVGAnimatedNumberList",
  "SVGAnimatedPreserveAspectRatio", "SVGAnimatedRect", "SVGAnimatedString",
  "SVGAnimatedTransformList", "SVGAnimationElement", "SVGCircleElement",
  "SVGClipPathElement", "SVGComponentTransferFunctionElement", "SVGDefsElement",
  "SVGDescElement", "SVGElement", "SVGEllipseElement", "SVGFEBlendElement",
  "SVGFEColorMatrixElement", "SVGFEComponentTransferElement",
  "SVGFECompositeElement", "SVGFEConvolveMatrixElement",
  "SVGFEDiffuseLightingElement", "SVGFEDisplacementMapElement",
  "SVGFEDistantLightElement", "SVGFEDropShadowElement", "SVGFEFloodElement",
  "SVGFEFuncAElement", "SVGFEFuncBElement", "SVGFEFuncGElement",
  "SVGFEFuncRElement", "SVGFEGaussianBlurElement", "SVGFEImageElement",
  "SVGFEMergeElement", "SVGFEMergeNodeElement", "SVGFEMorphologyElement",
  "SVGFEOffsetElement", "SVGFEPointLightElement",
  "SVGFESpecularLightingElement", "SVGFESpotLightElement", "SVGFETileElement",
  "SVGFETurbulenceElement", "SVGFilterElement", "SVGForeignObjectElement",
  "SVGGElement", "SVGGeometryElement", "SVGGradientElement",
  "SVGGraphicsElement", "SVGImageElement", "SVGLength", "SVGLengthList",
  "SVGLineElement", "SVGLinearGradientElement", "SVGMPathElement",
  "SVGMarkerElement", "SVGMaskElement", "SVGMatrix", "SVGMetadataElement",
  "SVGNumber", "SVGNumberList", "SVGPathElement", "SVGPathSegList",
  "SVGPatternElement", "SVGPoint", "SVGPointList", "SVGPolygonElement",
  "SVGPolylineElement", "SVGPreserveAspectRatio", "SVGRadialGradientElement",
  "SVGRect", "SVGRectElement", "SVGSVGElement", "SVGScriptElement",
  "SVGSetElement", "SVGStopElement", "SVGStringList", "SVGStyleElement",
  "SVGSwitchElement", "SVGSymbolElement", "SVGTSpanElement",
  "SVGTextContentElement", "SVGTextElement", "SVGTextPathElement",
  "SVGTextPositioningElement", "SVGTitleElement", "SVGTransform",
  "SVGTransformList", "SVGUnitTypes", "SVGUseElement", "SVGViewElement",
  "SVGZoomAndPan", "Screen", "ScreenOrientation", "ScriptProcessorNode",
  "ScrollAreaEvent", "SecurityPolicyViolationEvent", "Selection",
  "ServiceWorker", "ServiceWorkerContainer", "ServiceWorkerRegistration", "Set",
  "ShadowRoot", "SharedWorker", "SourceBuffer", "SourceBufferList",
  "SpeechSynthesis", "SpeechSynthesisErrorEvent", "SpeechSynthesisEvent",
  "SpeechSynthesisUtterance", "SpeechSynthesisVoice", "StereoPannerNode",
  "Storage", "StorageEvent", "StorageManager", "String", "StyleSheet",
  "StyleSheetList", "SubtleCrypto", "Symbol", "SyntaxError", "Text",
  "TextDecoder", "TextEncoder", "TextMetrics", "TextTrack", "TextTrackCue",
  "TextTrackCueList", "TextTrackList", "TimeEvent", "TimeRanges", "TrackEvent",
  "TransitionEvent", "TreeWalker", "TypeError", "UIEvent", "URIError", "URL",
  "URLSearchParams", "Uint16Array", "Uint32Array", "Uint8Array",
  "Uint8ClampedArray", "VTTCue", "VTTRegion", "ValidityState",
  "VideoPlaybackQuality", "VisualViewport", "WaveShaperNode", "WeakMap",
  "WeakSet", "WebAssembly", "WebGL2RenderingContext", "WebGLActiveInfo",
  "WebGLBuffer", "WebGLContextEvent", "WebGLFramebuffer", "WebGLProgram",
  "WebGLQuery", "WebGLRenderbuffer", "WebGLRenderingContext", "WebGLSampler",
  "WebGLShader", "WebGLShaderPrecisionFormat", "WebGLSync", "WebGLTexture",
  "WebGLTransformFeedback", "WebGLUniformLocation", "WebGLVertexArrayObject",
  "WebKitCSSMatrix", "WebSocket", "WheelEvent", "Window", "Worker",
  "XMLDocument", "XMLHttpRequest", "XMLHttpRequestEventTarget",
  "XMLHttpRequestUpload", "XMLSerializer", "XPathEvaluator", "XPathExpression",
  "XPathResult", "XSLTProcessor", "alert", "applicationCache", "atob", "blur",
  "btoa", "caches", "cancelAnimationFrame", "cancelIdleCallback",
  "captureEvents", "clearInterval", "clearTimeout", "close", "closed",
  "confirm", "console", "content", "createImageBitmap", "crypto",
  "customElements", "decodeURI", "decodeURIComponent", "devicePixelRatio",
  "document", "dump", "encodeURI", "encodeURIComponent", "escape", "eval",
  "event", "external", "fetch", "find", "focus", "frameElement", "frames",
  "fullScreen", "getComputedStyle", "getDefaultComputedStyle", "getSelection",
  "history", "indexedDB", "innerHeight", "innerWidth", "isFinite", "isNaN",
  "isSecureContext", "length", "localStorage", "location", "locationbar",
  "matchMedia", "menubar", "moveBy", "moveTo", "mozInnerScreenX",
  "mozInnerScreenY", "mozPaintCount", "mozRTCIceCandidate",
  "mozRTCPeerConnection", "mozRTCSessionDescription", "name", "navigator",
  "netscape", "onabort", "onabsolutedeviceorientation", "onafterprint",
  "onanimationcancel", "onanimationend", "onanimationiteration",
  "onanimationstart", "onauxclick", "onbeforeprint", "onbeforeunload", "onblur",
  "oncanplay", "oncanplaythrough", "onchange", "onclick", "onclose",
  "oncontextmenu", "ondblclick", "ondevicelight", "ondevicemotion",
  "ondeviceorientation", "ondeviceproximity", "ondrag", "ondragend",
  "ondragenter", "ondragexit", "ondragleave", "ondragover", "ondragstart",
  "ondrop", "ondurationchange", "onemptied", "onended", "onerror", "onfocus",
  "ongotpointercapture", "onhashchange", "oninput", "oninvalid", "onkeydown",
  "onkeypress", "onkeyup", "onlanguagechange", "onload", "onloadeddata",
  "onloadedmetadata", "onloadend", "onloadstart", "onlostpointercapture",
  "onmessage", "onmessageerror", "onmousedown", "onmouseenter", "onmouseleave",
  "onmousemove", "onmouseout", "onmouseover", "onmouseup",
  "onmozfullscreenchange", "onmozfullscreenerror", "onoffline", "ononline",
  "onpagehide", "onpageshow", "onpause", "onplay", "onplaying",
  "onpointercancel", "onpointerdown", "onpointerenter", "onpointerleave",
  "onpointermove", "onpointerout", "onpointerover", "onpointerup", "onpopstate",
  "onprogress", "onratechange", "onreset", "onresize", "onscroll", "onseeked",
  "onseeking", "onselect", "onselectstart", "onshow", "onstalled", "onstorage",
  "onsubmit", "onsuspend", "ontimeupdate", "ontoggle", "ontransitioncancel",
  "ontransitionend", "ontransitionrun", "ontransitionstart", "onunload",
  "onuserproximity", "onvolumechange", "onwaiting", "onwebkitanimationend",
  "onwebkitanimationiteration", "onwebkitanimationstart",
  "onwebkittransitionend", "onwheel", "open", "opener", "origin", "outerHeight",
  "outerWidth", "pageXOffset", "pageYOffset", "parent", "parseFloat",
  "parseInt", "performance", "personalbar", "postMessage", "print", "prompt",
  "releaseEvents", "requestAnimationFrame", "requestIdleCallback", "resizeBy",
  "resizeTo", "screen", "screenLeft", "screenTop", "screenX", "screenY",
  "scroll", "scrollBy", "scrollByLines", "scrollByPages", "scrollMaxX",
  "scrollMaxY", "scrollTo", "scrollX", "scrollY", "scrollbars", "self",
  "sessionStorage", "setInterval", "setResizable", "setTimeout", "sidebar",
  "sizeToContent", "speechSynthesis", "status", "statusbar", "stop", "toolbar",
  "top", "undefined", "unescape", "uneval", "updateCommands", "window",
  /* Chrome-unique items */
  "BigUint64Array", "BigInt64Array", "BigInt", "webkitRTCPeerConnection",
  "webkitMediaStream", "TextEncoderStream", "TextDecoderStream", "SyncManager",
  "RTCErrorEvent", "RTCError", "PhotoCapabilities", "OverconstrainedError",
  "NetworkInformation", "MediaSettingsRange", "MIDIPort", "MIDIOutputMap",
  "MIDIOutput", "MIDIMessageEvent", "MIDIInputMap", "MIDIInput",
  "MIDIConnectionEvent", "MIDIAccess", "InputDeviceInfo", "ImageCapture",
  "CanvasCaptureMediaStreamTrack", "BeforeInstallPromptEvent",
  "AudioWorkletNode", "AudioParamMap", "WritableStream", "TransformStream",
  "TouchList", "TouchEvent", "Touch", "TextEvent", "TaskAttributionTiming",
  "StylePropertyMapReadOnly", "StylePropertyMap", "StaticRange",
  "SVGDiscardElement", "ResizeObserverEntry", "ResizeObserver",
  "ReportingObserver", "PromiseRejectionEvent", "PerformancePaintTiming",
  "PerformanceLongTaskTiming", "InputDeviceCapabilities", "HTMLShadowElement",
  "HTMLDialogElement", "HTMLContentElement", "External",
  "CSSVariableReferenceValue", "CSSUnparsedValue", "CSSUnitValue",
  "CSSTranslate", "CSSTransformValue", "CSSTransformComponent", "CSSStyleValue",
  "CSSSkewY", "CSSSkewX", "CSSSkew", "CSSScale", "CSSRotate",
  "CSSPositionValue", "CSSPerspective", "CSSNumericValue", "CSSNumericArray",
  "CSSMatrixComponent", "CSSMathValue", "CSSMathSum", "CSSMathProduct",
  "CSSMathNegate", "CSSMathMin", "CSSMathMax", "CSSMathInvert",
  "CSSKeywordValue", "CSSImageValue", "WebKitMutationObserver", "webkitURL",
  "visualViewport", "clientInformation", "offscreenBuffering", "defaultStatus",
  "defaultstatus", "styleMedia", "onsearch", "oncancel", "oncuechange",
  "onmousewheel", "onselectionchange", "onrejectionhandled",
  "onunhandledrejection", "queueMicrotask", "webkitRequestAnimationFrame",
  "webkitCancelAnimationFrame", "onappinstalled", "onbeforeinstallprompt",
  "ondeviceorientationabsolute", "webkitStorageInfo", "SharedArrayBuffer",
  "Atomics", "globalThis", "chrome", "OffscreenCanvas", "UserActivation",
  "BackgroundFetchManager", "BackgroundFetchRecord",
  "BackgroundFetchRegistration", "MediaMetadata", "MediaSession",
  "OffscreenCanvasRenderingContext2D", "PaymentInstruments", "PaymentManager",
  "PaymentRequestUpdateEvent", "EnterPictureInPictureEvent",
  "PictureInPictureWindow", "RemotePlayback", "webkitSpeechGrammar",
  "webkitSpeechGrammarList", "webkitSpeechRecognition",
  "webkitSpeechRecognitionError", "webkitSpeechRecognitionEvent",
  "webkitRequestFileSystem", "webkitResolveLocalFileSystemURL", "openDatabase",
  "Worklet", "ApplicationCache", "ApplicationCacheErrorEvent", "AudioWorklet",
  "FederatedCredential", "Keyboard", "KeyboardLayoutMap", "Lock", "LockManager",
  "NavigationPreloadManager", "PasswordCredential", "PaymentAddress",
  "PaymentRequest", "PaymentResponse", "Presentation",
  "PresentationAvailability", "PresentationConnection",
  "PresentationConnectionAvailableEvent", "PresentationConnectionCloseEvent",
  "PresentationConnectionList", "PresentationReceiver", "PresentationRequest",
  "AbsoluteOrientationSensor", "Accelerometer", "Gyroscope",
  "LinearAccelerationSensor", "OrientationSensor", "RelativeOrientationSensor",
  "Sensor", "SensorErrorEvent", "USB", "USBAlternateInterface",
  "USBConfiguration", "USBConnectionEvent", "USBDevice", "USBEndpoint",
  "USBInterface", "USBInTransferResult", "USBIsochronousInTransferPacket",
  "USBIsochronousInTransferResult", "USBIsochronousOutTransferPacket",
  "USBIsochronousOutTransferResult", "USBOutTransferResult",
  "DeviceMotionEventAcceleration", "DeviceMotionEventRotationRate",
  /* Items added to Firefox after initial deployment */
  "AnonymousContent", "StyleSheetApplicableStateChangeEvent"
];
  </script>
  <script type="text/javascript">

function Checks() {
  function escape(s) {
    return s.replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&apos;");
  }

  function to_source(obj) {
    if (typeof(obj) === "object") {
      if (Object.prototype.toSource) {
        return Object.prototype.toSource.call(obj).replace(/\n/g, " ");
      } else {
        return JSON.stringify(obj);
      }
    } else {
      return JSON.stringify(obj);
    }
  }

  function add_message(s, cls, istext) {
    var $d = $(`<div class="line"></div>`);
    if (!!cls) {
      $d.addClass(cls);
    }
    if (istext) {
      $d.text(s);
    } else {
      $d.html(s);
    }
    $("div.content")[0].appendChild($d[0]);
  }

  function has_reflect() {
    return window.Reflect && typeof(window.Reflect) == "object";
  }

  function check_webkit() {
    /* Check for WebKit v8 */
    var v8string = 'function%20javaEnabled%28%29%20%7B%20%5Bnative%20code%5D%20%7D';
    if ('WebkitAppearance' in document.documentElement.style) {
      /* If (probably) WebKit browser */
      if (escape(navigator.javaEnabled.toString()) === v8string) {
        add_message('V8 detected');
      } else {
        add_message('JSC detected');
      }
    } else {
      add_message("Not a WebKit browser");
    }
  }

  function check_obs() {
    /* Check for OBSStudio */
    if (typeof(window["obsstudio"]) != "undefined") {
      add_message("window.obsstudio exists!", "im");
    } else {
      add_message("no window.obsstudio object");
    }
  }

  function check_reflect_window() {
    var new_attrs = [];
    var a;
    for (a of window["Reflect"].ownKeys(window)) {
      if (a == "DFLT_WINDOW_ATTRIBS") continue;
      if (a == "_ident_onready") continue;
      if (a == "jQuery") continue;
      if (a == "$") continue;
      if (a == "Checks" && typeof(window[a]) === "function") continue;
      if (typeof(navigator[a]) == "function") continue;
      if (window.DFLT_WINDOW_ATTRIBS.indexOf(a) > -1) continue;
      new_attrs.push(a);
    }
    var msg = "";
    for (var attr of new_attrs) {
      msg = msg + ` &quot;<pre class="im">${attr}</pre>&quot;`;
    }
    if (new_attrs.length > 0) {
      add_message(`New window objects:${msg}`);
    }
    console.log(new_attrs);
  }

  function check_reflect_navigator() {
    for (k of Reflect.ownKeys(navigator.__proto__)) {
      if (k === "userAgent") continue;
      if (typeof(k) !== "string") continue;
      if (typeof(navigator[k]) == "string") {
        let mk = `navigator.${k}`;
        let mv = `${to_source(navigator[k])}`;
        add_message(`<pre>${mk} = ${mv}</pre>`);
      }
    }
  }

  function check_navigator() {
    var members = ["oscpu", "vendor", "vendorSub", "productSub", "buildID",
                   "appCodeName", "appName", "appVersion", "platform", "product"];
    for (var m of members) {
      var k = `navigator["${m}"]`;
      var v = `${JSON.stringify(navigator[m])}`;
      add_message(`<pre>${k}</pre> = <pre>${v}</pre>`);
    }
  }

  function check_stack_format() {
    function foo() { throw new Error("test"); }
    function bar() { return foo(); }
    var stack = "";
    try { bar(); } catch (e) { stack = e.stack; }
    stack = escape(stack).replace(/\n/g, "<br/>");
    add_message(`Stacktrace: <pre>${stack}</pre>`);
  }

  let funcs = {
    to_source: to_source,
    add_message: add_message,
    has_reflect: has_reflect,
    check_webkit: check_webkit,
    check_obs: check_obs,
    check_reflect_window: check_reflect_window,
    check_reflect_navigator: check_reflect_navigator,
    check_navigator: check_navigator,
    check_stack_format: check_stack_format
  };
  return funcs;
}

function _ident_onready() {
  var C = Checks();
  C.add_message("Loaded");
  var supportsES6 = function() {
    /* Test anonymous closures with a default argument */
    try {
      var v0 = (new Function("return (a = 0) => a"))()();
      var v1 = (new Function("return (a = 0) => a"))()(1);
      return (v0 === 0 && v1 === 1);
    }
    catch (err) {
      return false;
    }
  }();
  if (!supportsES6) {
    C.add_message(`<pre class="im">NO ES6 SUPPORT</pre>`);
  }
  C.check_webkit();
  C.check_obs();
  C.add_message(`<pre>navigator.userAgent = ${C.to_source(navigator.userAgent)}</pre>`);
  if (C.has_reflect()) { 
    C.check_reflect_window();
    C.check_reflect_navigator();
  } else {
    C.check_navigator();
    C.add_message("Window does not have reflect object");
  }
  C.check_stack_format();

  /* Allow script injection */
  $("#inject").click(function(e) {
    let result = "";
    try {
      let func = new Function("return " + $("#injector").val());
      result = `${func()}`;
      $("#injector").val("");
    }
    catch (error) {
      result = `${error}`;
    }
    let $l = $(`<div class="line"></div>`).text(result);
    $("#injOutput")[0].appendChild($l[0]);
  });
}

$(document).ready(_ident_onready);
  </script>
</head>
<body>
<div class="content">
  <div class="line" style="display: none">Browser Identification Study</div>
</div>
<div class="injector">
  <div id="injOutput" class="injOutput"></div>
  <div class="injButton">
    <input id="inject" type="button" value="Run" />
  </div>
  <div class="injText">
    <textarea id="injector" width="100"></textarea>
  </div>
</div>
</body>
</html>
